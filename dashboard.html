<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Boss Dashboard - Prakalya Netzone</title>
  <style>
    body { font-family: Arial; background: #eef3f9; padding: 20px; }
    h1 { text-align: center; color: #0056d6; }
    .filters, .table-box, .password-box { max-width: 1000px; margin: auto; background: white; padding: 20px; margin-top: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    input, select, button { margin: 5px; padding: 10px; border-radius: 5px; border: 1px solid #ccc; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #dceeff; }
    #totalBox { margin-top: 10px; text-align: right; font-weight: bold; }
  </style>
</head>
<body>
  <h1>PRAKALYA NETZONE</h1>
  <div class="filters">
    <label>From: <input type="date" id="fromDate" /></label>
    <label>To: <input type="date" id="toDate" /></label>
    <label>Wallet:
      <select id="walletFilter"><option>All Wallets</option></select>
    </label>
    <label>Staff:
      <select id="staffFilter"><option>All Staff</option></select>
    </label>
    <button onclick="refreshData()">ğŸ” Refresh</button>
    <button onclick="filterToday()">ğŸ“… Today</button>
    <button onclick="printEntries()">ğŸ“‹ Print</button>
    <button onclick="exportExcel()">ğŸ“¤ Export to Excel</button>
    <button onclick="exportPDF()">ğŸ“¤ Export to PDF</button>
    <button onclick="showReset()">ğŸ” Reset Password</button>
    <button onclick="logout()">ğŸšª Logout</button>
    <div id="totalBox">Total: â‚¹0</div>
  </div>
  <div class="table-box">
    <table id="entryTable">
      <thead><tr><th>Date</th><th>Wallet</th><th>Closing</th><th>Note</th><th>Staff Code</th><th>Staff Name</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
  <div class="password-box" id="passwordBox" style="display:none;">
    <h3>ğŸ‘¥ Manage Staff Passwords</h3>
    <div id="passwordList"></div>
  </div>
  
<script>
  const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQnslASO3h9zdwLZrybq3Vn53gX6JEI8uhRXb5N4UFjcVKBkVeh02r5Y7LRBBXXQRp9gWm2Ke5Iujd8/pub?output=csv";
  let allRows = [];
  let currentPage = 1;
  const rowsPerPage = 20;

  function refreshData() {
    fetch(sheetURL)
      .then(res => res.text())
      .then(csv => {
        allRows = csv.trim().split("\n").map(row => row.split(",")).slice(1);
        currentPage = 1;
        renderTable();
      });
  }

  function renderTable() {
    const from = document.getElementById("fromDate").value || "0000-00-00";
    const to = document.getElementById("toDate").value || "9999-12-31";
    const wallet = document.getElementById("walletFilter").value;
    const staff = document.getElementById("staffFilter").value;

    const tbody = document.querySelector("#entryTable tbody");
    tbody.innerHTML = "";

    const filtered = allRows.filter(([date, wal, close, note, code, name]) => {
      return date >= from && date <= to &&
             (wallet === "All Wallets" || wal === wallet) &&
             (staff === "All Staff" || name === staff);
    });

    const total = filtered.reduce((sum, row) => sum + parseFloat(row[2] || 0), 0);
    document.getElementById("totalBox").textContent = "Total: â‚¹" + total.toLocaleString();

    const start = (currentPage - 1) * rowsPerPage;
    const pageRows = filtered.slice(start, start + rowsPerPage);
    pageRows.forEach(([date, wal, close, note, code, name]) => {
      const tr = document.createElement("tr");
      [date, wal, close, note, code, name].forEach(text => {
        const td = document.createElement("td");
        td.textContent = text;
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });
  }

  function filterToday() {
    const today = new Date().toISOString().split("T")[0];
    document.getElementById("fromDate").value = today;
    document.getElementById("toDate").value = today;
    renderTable();
  }

  function logout() {
    sessionStorage.clear();
    window.location.href = "index.html";
  }

  window.onload = refreshData;
</script>

    const staffUsers = [{ id: "001", name: "user" }, { id: "002", name: "SEKAR" }];
    function showReset() {
      document.getElementById('passwordBox').style.display = 'block';
      const list = document.getElementById("passwordList");
      list.innerHTML = staffUsers.map(user =>
        `<div>${user.id} - ${user.name} <button onclick="alert('Resetting ${user.id}')">Reset</button></div>`).join("");
    }
    function logout() { alert("Logging out..."); }
    function refreshData() {}
    function filterToday() {}
    function printEntries() {}
    function exportExcel() {}
    function exportPDF() {}
  </script>
</body>
</html>